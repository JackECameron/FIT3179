{
   "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
   "config":{
      "legend":{
         "disable":true
      },
      "background": "#161a1d"
   },
   "width": 200,
   "padding":0,
   "data":{
      "url":"https://raw.githubusercontent.com/JackECameron/FIT3179/main/D2_resources/data/stationData/stationData_long.csv",
      "format":{
         "type":"csv"
      }
   },
   "transform":[
      {
         "filter":"datum.stationNum == 10"
      }
   ],
   "encoding": { "theta":{
               "field":"perc",
               "type":"quantitative",
               "stack":true
            }},
   "layer":[
      {
         "mark":{
            "type":"arc",
            "radius2":70,
            "radius":120,
            "stroke": "#161a1d",
            "strokeWidth": 10,
            "cornerRadius": 10
         },
         "transform":[
            {
               "filter":"datum.class == 'unit'"
            },
              {
               "filter":"datum.perc != 0"
            },
            {"calculate": "datum.perc + '%'", "as": "perLabel1"}
         ],
         "encoding":{
            
            "color":{
               "field":"type",
               "type":"nominal",
               "scale":{"scheme":"greys", "type": "ordinal"}
            },
            "tooltip":[
              {
                 "field":"decrip",
                 "type":"nominal",
                 "title":"Equipment Class"
              },
              {
                 "field":"quant",
                 "type":"quantitative",
                 "title":"Total Number"
              },
              {
                 "field":"perLabel1",
                 "title":"Percent of Equipment"
              }
             
           ]
         }
      },
      {
         "mark":{
            "type":"text",
            "radius":95,
            "color":"#161a1d",
            "opacity":1
         },
         "transform":[
            {
               "filter":"datum.class == 'unit'"
            },
              {
               "filter":"datum.perc != 0"
            },
            {"calculate": "datum.perc + '%'", "as": "perLabel2"}
         ],
         "encoding":{
           
            "text":{
               "field":"perc",
               "aggregate": "sum"
            },
        "detail": {"field": "type", "type": "nominal"}
         }
      },
      {
         "mark":{
            "type":"arc",
            "radius2":120,
            "radius":170,
            "stroke": "#161a1d",
            "strokeWidth": 10,
            "cornerRadius": 10
         },
         "transform":[
            {
               "filter":"datum.class == 'equipment'"
            },
              {
               "filter":"datum.perc != 0"
            },
            {"calculate": "datum.perc + '%'", "as": "perLabel2"}
         ],
         "encoding":{
           
            "color":{
               "field":"type",
               "type":"nominal"
            },
            "tooltip":[
              {
                 "field":"decrip",
                 "type":"nominal",
                 "title":"Equipment Type"
              },
              {
                 "field":"quant",
                 "type":"quantitative",
                 "title":"Total Number"
              },
              {
                 "field":"perLabel2",
                 "title":"Percent of Equipment"
              }
             
           ]
         }
      },
      {
         "mark":{
            "type":"text",
            "radius":145,
            "color":"white",
            "opacity": 1
         },
         "transform":[
            {
               "filter":"datum.class == 'equipment'"
            },
              {
               "filter":"datum.perc != 0"
            },
            {"calculate": "datum.perc + '%'", "as": "perLabel2"}
         ],
         "encoding":{
            "text":{
               "field":"perc",
               "aggregate": "sum"
            },
        "detail": {"field": "type", "type": "nominal"}
         }
      }
   ],
   "view":{
      "stroke":null
   }
}